generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Category {
  id        Int       @id(map: "categories_pkey") @default(autoincrement())
  name      String?
  createdAt DateTime? @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime? @map("updated_at") @db.Timestamptz(6)
  isActive  Boolean?  @map("is_active")
  subCategories SubCategory[]
  products      Product[]     @relation("CategoryToProduct")

  @@map("product_categories")
}

model SubCategory {
  id         Int       @id(map: "sub_categories_pkey") @default(autoincrement())
  name       String?
  createdAt  DateTime? @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime? @map("updated_at") @db.Timestamptz(6)
  isActive   Boolean?  @map("is_active")
  categoryId Int?      @map("category_fkid")
  category   Category? @relation(fields: [categoryId], references: [id])
  products   Product[]

  @@map("product_sub_categories")
}

model Product {
  id              Int               @id @default(autoincrement())
  name            String?
  type_fkid       Int?
  categoryId      Int?              @map("category_fkid")
  subCategoryId   Int?              @map("sub_category_fkid")
  description     String?
  createdAt       DateTime?         @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime?         @map("updated_at") @db.Timestamptz(6)
  use_variant     Boolean?
  isActive        Boolean?          @default(true) @map("is_active")
  tmp_price_buy   Decimal?          @db.Decimal(12, 2)
  price           Decimal?          @map("tmp_price_sell") @db.Decimal(12, 2)
  vendor_fkid     Int?
  product_options product_options[]
  productType     product_types?    @relation(fields: [type_fkid], references: [id])
  category        Category?         @relation("CategoryToProduct", fields: [categoryId], references: [id])
  subCategory     SubCategory?      @relation(fields: [subCategoryId], references: [id])

  @@index([categoryId], map: "idx_products_category")
  @@index([isActive], map: "idx_products_is_active")
  @@index([subCategoryId], map: "idx_products_sub_category")
  @@index([type_fkid], map: "idx_products_type")
  @@map("products")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model ProductImage {
  id        Int      @default(autoincrement())
  productId Int?     @map("product_fkid")
  image     String?
  isVariant Boolean? @default(false) @map("is_variant")

  @@index([productId], map: "idx_product_images_product")
  @@map("product_images")
  @@ignore
}

model app_config {
  config_id    Int       @id
  config_group String?   @db.VarChar(50)
  config_name  String?   @db.VarChar(50)
  config_value String?   @db.VarChar(255)
  created_at   DateTime? @db.Timestamp(6)
  created_by   Int?
  updated_at   DateTime? @db.Timestamp(6)
  updated_by   Int?
}

model app_menu {
  menu_id    Int       @id
  portal_id  Int
  parent_id  Int?      @default(0)
  menu_title String?   @db.VarChar(100)
  menu_url   String?   @db.VarChar(100)
  menu_desc  String?   @db.VarChar(255)
  menu_icon  String?   @db.VarChar(100)
  sort       Int?
  is_active  Boolean?  @default(false)
  is_show    Boolean?  @default(false)
  created_at DateTime? @db.Timestamp(6)
  created_by Int?
  updated_at DateTime? @db.Timestamp(6)
  updated_by Int?
}

model app_portal {
  portal_id    Int       @id
  portal_name  String?   @db.VarChar(100)
  portal_desc  String?   @db.VarChar(255)
  meta_keyword String?   @db.VarChar(100)
  meta_desc    String?   @db.VarChar(255)
  meta_author  String?   @db.VarChar(255)
  is_active    Boolean?  @default(false)
  created_at   DateTime? @db.Timestamp(6)
  created_by   Int?
  updated_at   DateTime? @db.Timestamp(6)
  updated_by   Int?
}

model app_role {
  role_id      Int       @id
  portal_id    Int
  role_name    String?   @db.VarChar(100)
  role_desc    String?   @db.VarChar(255)
  default_page String?   @db.VarChar(100)
  is_active    Boolean?  @default(false)
  created_at   DateTime? @db.Timestamp(6)
  created_by   Int?
  updated_at   DateTime? @db.Timestamp(6)
  updated_by   Int?

  @@index([portal_id], map: "idx_app_role_portal_id")
}

model app_role_menu {
  role_id Int
  menu_id Int

  @@id([role_id, menu_id])
}

model app_user {
  user_id        Int            @id @default(autoincrement())
  user_name      String?        @unique(map: "unique_user_name") @db.VarChar(255)
  user_password  String?        @db.VarChar(255)
  is_locked      Boolean?       @default(false)
  created_at     DateTime?      @db.Timestamp(6)
  updated_at     DateTime?      @db.Timestamp(6)
  user_pin_sales String?
  stock_opname   stock_opname[]
  user_outlet    user_outlet[]
}

model app_user_detail {
  user_id      Int       @id
  nama_lengkap String?   @db.VarChar(100)
  nik          Decimal?  @db.Decimal(10, 0)
  email        String?   @db.VarChar(255)
  phone        String?   @db.VarChar(255)
  alamat       String?   @db.VarChar(255)
  image_ktp    String?   @db.VarChar(255)
  created_at   DateTime? @db.Timestamp(6)
  updated_at   DateTime? @db.Timestamp(6)
  tgl_lahir    DateTime? @db.Date
  tempat_lahir String?   @db.VarChar(255)
  image        String?   @db.VarChar(255)
}

model app_user_role {
  user_id Int
  role_id Int

  @@id([user_id, role_id])
}

model customer {
  id             Int       @id(map: "member_pkey") @default(autoincrement())
  name           String?
  phone          String?
  email          String?
  address        String?
  image          String?
  created_at     DateTime? @db.Timestamptz(6)
  updated_at     DateTime? @db.Timestamptz(6)
  is_active      Boolean?
  province_fkid  BigInt?
  regency_fkid   BigInt?
  district_fkid  BigInt?
  village_fkid   BigInt?
  detail_address String?
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model gratuity {
  id                        Int            @id @default(autoincrement())
  category                  String?
  name                      String?
  amount                    Decimal?       @db.Decimal(10, 2)
  gratuity_type_fkid        Int?
  start_date                DateTime?      @db.Timestamptz(6)
  end_date                  DateTime?      @db.Timestamptz(6)
  gratuity_active_type_fkid Int?
  is_active                 Boolean?       @default(true)
  gratuity_type             gratuity_type? @relation(fields: [gratuity_type_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model gratuity_active_type {
  id          Int     @id @default(autoincrement())
  type_active String?
  note        String?
}

model gratuity_type {
  id                    Int                     @id @default(autoincrement())
  name                  String?
  gratuity              gratuity[]
  sales_detail_gratuity sales_detail_gratuity[]
  sales_gratuity        sales_gratuity[]
}

model log_login {
  log_id     Int       @id
  user_id    Int
  ip_address String?   @db.VarChar(100)
  user_agent String?   @db.VarChar(255)
  login_at   DateTime? @db.Timestamp(6)
  logout_at  DateTime? @db.Timestamp(6)
  location   String?   @db.VarChar(255)
}

model m_product_option {
  id                      Int                       @id @default(autoincrement())
  name                    String?
  is_active               Boolean?                  @default(true)
  created_at              DateTime?                 @db.Timestamptz(6)
  updated_at              DateTime?                 @db.Timestamptz(6)
  m_product_option_detail m_product_option_detail[]
}

model m_product_option_detail {
  id                    Int               @id @default(autoincrement())
  m_product_option_fkid Int?
  value                 String?
  is_active             Boolean?          @default(true)
  created_at            DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?         @default(now()) @db.Timestamptz(6)
  m_product_option      m_product_option? @relation(fields: [m_product_option_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model outlets {
  id                     Int                      @id @default(autoincrement())
  name                   String
  created_at             DateTime?                @db.Timestamptz(6)
  updated_at             DateTime?                @db.Timestamptz(6)
  is_active              Boolean?                 @default(true)
  product_variant_stocks product_variant_stocks[]
  promotion_outlet       promotion_outlet[]
  stock_movements        stock_movements[]
  stock_opname           stock_opname[]
  stock_summary          stock_summary[]
  user_outlet            user_outlet[]
}

model payment_media {
  id         Int       @id @default(autoincrement())
  name       String?
  created_at DateTime? @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
  is_active  Boolean?  @default(true)
}

model payment_type {
  id            Int             @id @default(autoincrement())
  name          String?
  sales_payment sales_payment[]
}

model product_option_values {
  id          Int    @id @default(autoincrement())
  option_fkid Int?
  value       String
}

model product_options {
  id           Int      @id @default(autoincrement())
  product_fkid Int?
  name         String
  products     Product? @relation(fields: [product_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model product_types {
  id         Int       @id(map: "type_pkey") @default(autoincrement())
  name       String?
  is_active  Boolean?
  created_at DateTime? @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
  products   Product[]
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model product_variant_gratuity {
  id                   Int      @default(autoincrement())
  product_variant_fkid Int?
  gratuity_fkid        Int?
  is_active            Boolean? @default(true)

  @@ignore
}

model product_variant_stocks {
  id               Int               @id @default(autoincrement())
  variant_fkid     Int?
  outlet_fkid      Int?
  qty              Decimal?          @default(0) @db.Decimal(12, 2)
  created_at       DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?         @default(now()) @db.Timestamptz(6)
  is_active        Boolean?          @default(true)
  outlets          outlets?          @relation(fields: [outlet_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  product_variants product_variants? @relation(fields: [variant_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([variant_fkid], map: "idx_variant_stocks_variant")
}

model product_variant_values {
  id                Int      @id @default(autoincrement())
  variant_fkid      Int?
  option_value_fkid Int?
  is_active         Boolean? @default(true)
}

model product_variants {
  id                     Int                      @id @default(autoincrement())
  product_fkid           Int?
  sku                    String?                  @unique
  price_buy              Decimal?                 @db.Decimal(12, 2)
  price_sell             Decimal?                 @db.Decimal(12, 2)
  is_active              Boolean?                 @default(true)
  product_variant_stocks product_variant_stocks[]
  stock_movements        stock_movements[]
  stock_opname           stock_opname[]
  stock_summary          stock_summary[]

  @@index([product_fkid], map: "idx_variants_product")
}

model promotion_outlet {
  id             Int         @id @default(autoincrement())
  outlet_fkid    Int?
  promotion_fkid Int?
  outlets        outlets?    @relation(fields: [outlet_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  promotions     promotions? @relation(fields: [promotion_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model promotions {
  id               Int                @id @default(autoincrement())
  promo_name       String?
  promo_type       String?
  max_discount     Decimal?           @db.Decimal(12, 2)
  nominal          Decimal?           @db.Decimal(12, 2)
  min_purchase     Decimal?           @db.Decimal(12, 2)
  start_date       DateTime?          @db.Timestamptz(6)
  end_date         DateTime?          @db.Timestamptz(6)
  description      String?
  created_at       DateTime?          @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?          @default(now()) @db.Timestamptz(6)
  is_active        Boolean?           @default(true)
  promotion_outlet promotion_outlet[]
}

model sales {
  id            Int             @id @default(autoincrement())
  invoice       String?
  customer_fkid Int?
  sub_total     Decimal?        @db.Decimal(12, 2)
  grand_total   Decimal?        @db.Decimal(12, 2)
  note          String?
  created_at    DateTime?       @db.Timestamptz(6)
  is_refund     Boolean?        @default(false)
  outlet_fkid   Int?
  employee_name String?
  delivery_date DateTime?       @db.Timestamptz(6)
  sales_payment sales_payment[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model sales_detail {
  id                             Int      @id @default(autoincrement())
  qty                            Int?
  price_sell                     Decimal? @db.Decimal(12, 2)
  price_buy                      Decimal? @db.Decimal(12, 2)
  total                          Decimal? @db.Decimal(12, 2)
  note                           String?
  product_variant_fkid           Int?
  sales_fkid                     Int?
  discount                       Decimal? @db.Decimal(12, 2)
  discount_info                  String?
  sales_detail_history_type_fkid Int?     @default(1)
  is_custom                      Boolean? @default(false)
  product_fkid                   Int?
  custom_note                    String?
}

model sales_detail_gratuity {
  id                 Int            @id(map: "sales_detail_taxs_pkey") @default(autoincrement())
  sales_detail_fkid  Int?
  gratuity_fkid      Int?
  total              Decimal?       @db.Decimal(12, 2)
  is_custom          Boolean?       @default(false)
  custom_name        String?
  gratuity_type_fkid Int?
  gratuity_type      gratuity_type? @relation(fields: [gratuity_type_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model sales_detail_history {
  id                Int       @id @default(autoincrement())
  sales_detail_fkid Int?
  status_fkid       Int?
  created_at        DateTime? @db.Timestamptz(6)
  created_by        Int?
  note              String?
}

model sales_detail_history_type {
  id     Int     @id(map: "sales_history_type_pkey") @default(autoincrement())
  status String?
}

model sales_gratuity {
  id                 Int            @id(map: "sales_tax_pkey") @default(autoincrement())
  sales_fkid         Int?
  total              Decimal?       @db.Decimal(12, 2)
  gratuity_fkid      Int?
  is_custom          Boolean?       @default(false)
  custom_name        String?
  gratuity_type_fkid Int?
  gratuity_type      gratuity_type? @relation(fields: [gratuity_type_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model sales_marketing_info {
  id              Int       @id @default(autoincrement())
  sales_fkid      Int?
  source_channel  String?
  closing_channel String?
  customer_status String?
  created_at      DateTime? @db.Timestamptz(6)
}

model sales_payment {
  id                 Int           @id @default(autoincrement())
  sales_fkid         Int?
  payment_type_fkid  Int?
  total              Decimal?      @db.Decimal(12, 2)
  payment_date       DateTime?     @db.Timestamptz(6)
  created_at         DateTime?     @db.Timestamptz(6)
  updated_at         DateTime?     @db.Timestamptz(6)
  payment_media_fkid Int?
  payment_type       payment_type? @relation(fields: [payment_type_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  sales              sales?        @relation(fields: [sales_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model sales_promotion {
  id             Int  @default(autoincrement())
  sales_fkid     Int?
  promotion_fkid Int?

  @@ignore
}

model spoil {
  id           Int       @id @default(autoincrement())
  qty          Decimal?  @db.Decimal(12, 2)
  user_fkid    Int?
  variant_fkid Int?
  note         String?
  created_at   DateTime? @db.Timestamptz(6)
  outlet_fkid  Int?
}

model stock_movement_types {
  id              Int               @id @default(autoincrement())
  code            String            @unique
  name            String
  description     String?
  stock_movements stock_movements[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model stock_movements {
  id                   Int                   @id @default(autoincrement())
  variant_fkid         Int?
  outlet_fkid          Int?
  movement_type_fkid   Int?
  qty                  Decimal?              @db.Decimal(12, 2)
  price                Decimal?              @db.Decimal(12, 2)
  reference            String?
  description          String?
  created_at           DateTime?             @default(now()) @db.Timestamp(6)
  stock_movement_types stock_movement_types? @relation(fields: [movement_type_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  outlets              outlets?              @relation(fields: [outlet_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  product_variants     product_variants?     @relation(fields: [variant_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model stock_opname {
  id                   Int               @id @default(autoincrement())
  product_variant_fkid Int?
  qty_in               Decimal?          @db.Decimal(12, 2)
  qty_out              Decimal?          @db.Decimal(12, 2)
  qty_system           Decimal?          @db.Decimal(12, 2)
  qty_opname           Decimal?          @db.Decimal(12, 2)
  created_by           Int?
  created_at           DateTime?         @db.Timestamptz(6)
  updated_at           DateTime?         @db.Timestamptz(6)
  difference           Decimal?          @db.Decimal(12, 2)
  outlet_fkid          Int?
  app_user             app_user?         @relation(fields: [created_by], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
  outlets              outlets?          @relation(fields: [outlet_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  product_variants     product_variants? @relation(fields: [product_variant_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model stock_summary {
  id               Int               @id(map: "stock_sumary_pkey") @default(autoincrement())
  variant_fkid     Int?
  stock_open       Decimal?          @db.Decimal(10, 2)
  stock_in         Decimal?          @db.Decimal(10, 2)
  stock_out        Decimal?          @db.Decimal(10, 2)
  outlet_fkid      Int?
  updated_at       DateTime?         @db.Timestamptz(6)
  is_active        Boolean?          @default(true)
  outlets          outlets?          @relation(fields: [outlet_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "stock_sumary_outlet_fkid_fkey")
  product_variants product_variants? @relation(fields: [variant_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "stock_sumary_variant_fkid_fkey")

  @@unique([outlet_fkid, variant_fkid], map: "stock_summary_unique_outlet_variant")
}

model user_outlet {
  id          Int       @id @default(autoincrement())
  user_fkid   Int?
  outlet_fkid Int?
  outlets     outlets?  @relation(fields: [outlet_fkid], references: [id], onDelete: NoAction, onUpdate: NoAction)
  app_user    app_user? @relation(fields: [user_fkid], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model vendor {
  id         Int       @default(autoincrement())
  name       String?
  is_active  Boolean?  @default(true)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}
